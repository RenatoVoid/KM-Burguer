<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KM BURGER - Pedir Agora</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        .bg-km-vinho { background-color: #4a0404; }
        .text-km-amarelo { color: #f59e0b; }
    </style>
</head>
<body class="bg-gray-100 pb-32">
    <header class="bg-km-vinho p-6 text-center text-white shadow-xl">
        <h1 class="text-3xl font-black italic text-km-amarelo">KM BURGER üçî</h1>
        <p id="status-loja" class="text-xs font-bold mt-2"></p>
    </header>

    <main id="menu" class="max-w-md mx-auto p-4 space-y-8">
        </main>

    <div id="modal-acai" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-sm p-6 overflow-hidden flex flex-col max-h-[90vh]">
            <h2 id="acai-titulo" class="text-xl font-bold text-purple-900"></h2>
            <div id="lista-adicionais" class="overflow-y-auto space-y-2 mt-4 pr-2"></div>
            <button onclick="confirmarAcai()" class="w-full bg-purple-600 text-white py-4 rounded-xl font-bold mt-4 shadow-lg">ADICIONAR</button>
            <button onclick="document.getElementById('modal-acai').classList.add('hidden')" class="w-full text-gray-400 mt-2">Voltar</button>
        </div>
    </div>

    <div class="fixed bottom-0 left-0 right-0 bg-white border-t p-4 shadow-2xl max-w-md mx-auto z-40 text-center">
        <span class="block text-gray-500 text-sm mb-1">Total: <b id="carrinho-total" class="text-green-600 text-lg">R$ 0,00</b></span>
        <button onclick="abrirCheckout()" class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold shadow-lg">FINALIZAR PEDIDO</button>
    </div>

    <div id="modal-checkout" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-sm p-6 shadow-2xl">
            <h2 class="text-xl font-bold mb-4 text-km-vinho">Dados da Entrega</h2>
            <input type="text" id="nome" placeholder="Seu Nome" class="w-full p-4 border rounded-xl mb-3 outline-none">
            <select id="tipo-entrega" onchange="toggleEndereco()" class="w-full p-4 border rounded-xl mb-3">
                <option value="entrega">Entrega (Delivery)</option>
                <option value="retirada">Retirada na Loja</option>
            </select>
            <input type="text" id="endereco" placeholder="Endere√ßo, N√∫mero e Bairro" class="w-full p-4 border rounded-xl mb-3">
            <input type="text" id="pagamento" placeholder="Forma de Pagamento" class="w-full p-4 border rounded-xl mb-4">
            <button onclick="enviarPedidoFirebase()" class="w-full bg-green-600 text-white py-5 rounded-2xl font-bold shadow-xl">ENVIAR PEDIDO</button>
        </div>
    </div>

    <script>
        // CONFIGURA√á√ÉO DO SEU FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyCXNjKn-uP2dpf_OG_pzUkqa-RnS-3V1L4",
            authDomain: "km-burguer.firebaseapp.com",
            projectId: "km-burguer",
            databaseURL: "https://km-burguer-default-rtdb.firebaseio.com",
            storageBucket: "km-burguer.firebasestorage.app",
            messagingSenderId: "426968901226",
            appId: "1:426968901226:web:e05f587e2c36acaa714c13"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // [O RESTANTE DO C√ìDIGO DO CARD√ÅPIO QUE CRIAMOS ANTES VEM AQUI...]
        // (Vou resumir a l√≥gica de envio para voc√™ ver o que muda)

        let carrinho = [];
        let totalGeral = 0;

        function enviarPedidoFirebase() {
            const nome = document.getElementById('nome').value;
            const end = document.getElementById('endereco').value;
            const tipo = document.getElementById('tipo-entrega').value;
            const pag = document.getElementById('pagamento').value;

            if(!nome) return alert("Digite seu nome!");

            const pedidoRef = db.ref('pedidos').push();
            const itensTxt = carrinho.map(i => i.n).join(', ');

            pedidoRef.set({
                cliente: nome,
                endereco: tipo === 'entrega' ? end : 'RETIRADA',
                itens: itensTxt,
                total: totalGeral,
                pagamento: pag,
                status: 'novos',
                hora: new Date().toLocaleTimeString('pt-BR')
            }).then(() => {
                alert("Pedido enviado com sucesso!");
                window.location.reload();
            });
        }
        // [Renderizar menu, acai, etc...]
    </script>
</body>
</html>